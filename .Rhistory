fig.align = "center",
comment = "#>"
)
# load data
copiers <- read.csv(file = "copiers.csv")
cor(copiers$Sales, copiers$Profit)
ggplot(data = copiers, mapping = aes(x = Sales)) +
geom_density()
# import libraries
library(dplyr)
library(ggplot2)
ggplot(data = copiers, mapping = aes(x = Sales)) +
geom_density()
ggplot(data = copiers, mapping = aes(y = Sales)) +
geom_boxplot()
copiers <- copiers %>%
filter(Sales < 4000)
copiers
library(manipulate)
expr1 <- function(mn){
mse <- mean((copiers$Sales - mn)^2)
hist(copiers$Sales, breaks=20, main=paste("mean = ", mn, "MSE=", round(mse, 2), sep=""))
abline(v=mn, lwd=2, col="darkred")
}
manipulate(expr1(mn), mn=slider(1260, 1360, step=10))
mean(copiers$Sales)
model1 <- lm(formula = Profit ~ 1, data = copiers)
model1$coefficients
mean(copiers$Profit)
ols <- lm(formula = Profit ~ Sales, data = copiers)
summary(ols)
sales_new <- c(300, 2900, 357, 502)
-83.54 + 0.394 * sales_new
predict(object = ols, newdata = data.frame("Sales" = sales_new))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
crime <- read.csv("data_input/crime.csv") %>%
dplyr::select(-X)
names(crime) <- c("percent_m", "is_south", "mean_education", "police_exp60", "police_exp59", "labour_participation", "m_per1000f", "state_pop", "nonwhites_per1000", "unemploy_m24", "unemploy_m39", "gdp", "inequality", "prob_prison", "time_prison", "crime_rate")
plot(crime$gdp, crime$inequality)
head(crime)
mean(copiers$Sales)
head(copiers$Sales)
hist(copiers$Sales)
mean(copiers$Profit)
lm(formula=Profit~1, data=copiers)
plot(copiers$Sales,copiers$Profit)
lm(formula=Profit~Sales, data=copiers)
model_1 <- lm(formula=Profit~Sales, data=copiers)
plot(x=copiers$Sales,y=copiers$Profit)
abline(model_1)
options(error = recover)
knitr::opts_chunk$set(echo = TRUE)
copiers <- read.csv("data_input/copiers.csv")
head(copiers)
unique(copiers$Row.ID)
levels(copiers$Sub.Category)
library(manipulate)
expr1 <- function(mn){
mse <- mean((copiers$Sales - mn)^2)
hist(copiers$Sales, breaks=20, main=paste("Center = ", mn, "MSE=", round(mse, 2), sep=""))
abline(v=mn, lwd=2, col="darkred")
}
manipulate(expr1(mn), mn=slider(1260, 1360, step=10))
mean(copiers$Sales)
summary(model_1)
model_1 <- lm(formula=Profit~Sales, data=copiers)
summary(model_1)
model_1
knitr::opts_chunk$set(echo = TRUE)
copiers <- read.csv("data_input/copiers.csv")
head(copiers)
plot(copiers$Sales,copiers$Profit)
mean(copiers$Profit)
lm(formula=Profit~1, data=copiers)
model_1 <- lm(formula=Profit~Sales, data=copiers)
model_1
plot(x=copiers$Sales,y=copiers$Profit)
abline(model_1)
summary(model_1)
predict(object = model_1,newdata = data.frame(sales_new))
sales_new <- c(300, 2900, 357, 502)
predict(object = model_1,newdata = data.frame(sales_new))
Sales <- c(300, 2900, 357, 502)
-114.0625 + 0.4229 * Sales
predict(object = model_1,newdata = data.frame(Sales))
expr1 <- function(mn){
mse <- mean((copiers$Sales - mn)^2)
hist(copiers$Sales, breaks=20, main=paste("Center = ", mn, "MSE=", round(mse, 2), sep=""))
abline(v=mn, lwd=2, col="darkred")
}
manipulate(expr1(mn), mn=slider(1260, 1360, step=10))
summary(model_1)
lm(Sales~1, ccopiers)
lm(Sales~1, copiers)
model_ols <- lm(formula=Profit~Sales, data=copiers)
model_ols
boxplot(copiers$Sales)
copiers[copiers$Sales>4000,]
copiers_no <- copiers[copiers$Sales<4000,]
model_no <- lm(Profit~Sales,data = copiers)
copiers_no <- copiers[copiers$Sales<4000,]
model_no <- lm(Profit~Sales,data = copiers)
plot(copiers$Sales, copiers$Profit)
abline(model_ols)
abline(model_no)
plot(copiers$Sales, copiers$Profit)
#abline(model_ols)
abline(model_no)
plot(copiers$Sales, copiers$Profit)
abline(model_ols)
#abline(model_no)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no)
plot(copiers$Sales,copiers$Profit)
abline(model_ols)
par(mfrow=c(1,2))
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no)
plot(copiers$Sales,copiers$Profit)
abline(model_ols)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no)
plot(copiers$Sales,copiers$Profit)
abline(model_ols)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no, col = "red")
abline(model_ols, col ="blue")
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
options(scipen = 123)
copiers <- read.csv("copiers.csv")
copiers <- read.csv("copiers.csv")
copiers_clean <- copiers[copiers$Sales<4000, ]
model1 <- lm(Profit~Sales, data = copiers)
model2 <- lm(Profit~Sales, copiers_clean)
plot(copiers$Sales, copiers$Profit)
abline(model1, col = "red")
abline(model2, col =  "blue")
copiers_no <- copiers[copiers$Sales<4000,]
model_no <- lm(Profit~Sales,data = copiers_no)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no, col = "red")
abline(model_ols, col ="blue")
copiers_outlier <- copiers[59,"Profit"] + 3000
copiers_outlier <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Proft ~ Sales,data = copiers_outlier)
copiers[59,"Profit"] + 3000
copiers_outlier <- copiers[copiers[59,"Profit"] + 3000,]
copiers_outlier
copiers[59,"Profit"] <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Proft ~ Sales,data = copiers)
copiers[59,"Profit"] <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Profit ~ Sales,data = copiers)
copiers[59,"Profit"] <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Profit ~ Sales,data = copiers)
plot(copiers$Sales, copiers$Profit)
abline(model_outlier)
crime <- read.csv("data_input/crime.csv")
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
p_value <- cor.test.all(crime, "inequality")
crime <- read.csv("data_input/crime.csv") %>%
dplyr::select(-X)
library(dplyr)
crime <- read.csv("data_input/crime.csv") %>%
dplyr::select(-X)
names(crime) <- c("percent_m", "is_south", "mean_education", "police_exp60", "police_exp59", "labour_participation", "m_per1000f", "state_pop", "nonwhites_per1000", "unemploy_m24", "unemploy_m39", "gdp", "inequality", "prob_prison", "time_prison", "crime_rate")
head(crime)
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
p_value <- cor.test.all(crime, "inequality")
p_value
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = round(as.numeric(p_value),2))
df  <- rbind(df,temp)
}
return(df)
}
p_value <- cor.test.all(crime, "inequality")
p_value
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = round(as.numeric(p_value),4))
df  <- rbind(df,temp)
}
return(df)
}
p_value <- cor.test.all(crime, "inequality")
p_value
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
p_value <- cor.test.all(crime, "inequality")
p_value
setwd("D:/machinelearning-FAQ")
# clear-up the environment
rm(list = ls())
# chunk options
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
fig.align = "center",
comment = "#>"
)
# scientific notation
options(scipen = 9999)
copiers <- read.csv("data/01-RM/copiers.csv")
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = crime,target =  "inequality")
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = crime,target ="Profit")
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = copiers,target ="Profit")
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]] %>% select_if(is.numeric())
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = copiers,target ="Profit")
copiers %>% select_if(is.numeric())
copiers %>% select_if(is.numeric)
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]] %>% select_if(is.numeric)
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = crime,target ="Profit")
cor.test.all <- function(data,target) {
names <- names(data)
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]] %>% select_if(is.numeric)
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = copiers,target ="Profit")
names(copiers %>% select_if(is.numeric))
copiers %>% select_if(is.numeric)
names(copiers)
names(copiers) %>% select_if(is.numeric)
names(copiers %>% select_if(is.numeric))
cor.test.all <- function(data,target) {
names <- names(data %>% select_if(is.numeric))
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = copiers,target ="Profit")
copiers <- read.csv("data/01-RM/copiers.csv") %>% select(-Row.ID)
cor.test.all <- function(data,target) {
names <- names(data %>% select_if(is.numeric))
df <- NULL
for (i in 1:length(names)) {
y <- target
x <- names[[i]]
p_value <- cor.test(data[,y], data[,x])[3]
temp <- data.frame(x = x,
y = y,
p_value = as.numeric(p_value))
df  <- rbind(df,temp)
}
return(df)
}
cor.test.all(data = copiers,target ="Profit")
cor.test(copiers$Sales, copiers$Profit)
library(bookdown)
render_book("book")
render_book("book")
copiers[59,"Profit"] <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Profit ~ Sales,data = copiers)
plot(copiers_no$Sales, copiers_no$Profit)
knitr::opts_chunk$set(echo = TRUE)
copiers <- read.csv("data_input/copiers.csv")
head(copiers)
plot(copiers$Sales,copiers$Profit)
mean(copiers$Profit)
lm(formula=Profit~1, data=copiers)
model_ols <- lm(formula=Profit~Sales, data=copiers)
model_ols
plot(x=copiers$Sales,y=copiers$Profit)
abline(model_ols)
Sales <- c(300, 2900, 357, 502)
-114.0625 + 0.4229 * Sales
predict(object = model_ols,newdata = data.frame(Sales))
summary(model_ols)
boxplot(copiers$Sales)
copiers[copiers$Sales>4000,]
copiers_no <- copiers[copiers$Sales<4000,]
model_no <- lm(Profit~Sales,data = copiers_no)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no, col = "red")
abline(model_ols, col ="blue")
copiers[59,"Profit"] <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Profit ~ Sales,data = copiers)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no, col = "red")
abline(model_ols, col ="blue")
abline(model_outlier)
copiers[59,"Profit"] <- copiers[59,"Profit"] + 3000
model_outlier <- lm(Profit ~ Sales,data = copiers)
plot(copiers_no$Sales, copiers_no$Profit)
abline(model_no, col = "red")
abline(model_ols, col ="blue")
abline(model_outlier, col = "green")
ChickWeight
glimpse(ChickWeight)
?ChickWeight
summary(ChickWeight)
levels(ChickWeight$Chick)
airquality
library(MASS)
library(MASS)
data(hills)
head(hills)
boxplot(copiers$Profit, plot = F)$out
boxplot(copiers$Profit, plot = F)
boxplot(copiers$Profit)
hist(copiers$Profit)
boxplot(copiers$Profit)
hist(copiers$Profit)
boxplot(copiers$Profit)
boxplot(copiers$Profit, plot = F)$out
boxplot(copiers$Profit)
boxplot(copiers$Sales)
?mtcars
house <- read.csv("data_input/kc_house_data.csv")
house <- read.csv("data_input/kc_house_data.csv")
head(house)
library(lubridate)
head(house)
ymd_hms(head(house$date))
ymd(head(house$date))
ymd_hms(head(house$date))
head(house)
house %>%
mutate(date = ymd_hms(head(house$date)),
taun = year(date))
house %>%
mutate(date = ymd_hms(date),
taun = year(date))
head(house)
lm(price~sqft_lot,data = house)
plot(house$sqft_lot, house$price)
model_house <- lm(price~sqft_lot,data = house)
summary(model_house)
summary(house$price)
model_house <- lm(price~sqft_lot+bedrooms+bathrooms+floors,data = house)
summary(model_house)
model_house <- lm(price~sqft_lot+bedrooms+bathrooms+floors+waterfront,data = house)
summary(model_house)
model_house <- lm(price~sqft_lot+bedrooms+bathrooms+floors+waterfront+yr_built,data = house)
summary(model_house)
house <- read.csv("data_input/kc_house_data.csv") %>% select(-c(1:2))
house <- read.csv("data_input/kc_house_data.csv") %>% select(-(1:2))
house <- read.csv("data_input/kc_house_data.csv") %>% select(-1:2))
house <- read.csv("data_input/kc_house_data.csv") %>% select(-c(1:2))
house <- read.csv("data_input/kc_house_data.csv") %>% select(-1:2)
house <- read.csv("data_input/kc_house_data.csv") %>% select(-c(1,2))
house <- read.csv("data_input/kc_house_data.csv") %>% select(1:2)
house <- read.csv("data_input/kc_house_data.csv") %>% select(-(id,date))
house <- read.csv("data_input/kc_house_data.csv") %>% select(-c(id,date))
house <- read.csv("data_input/kc_house_data.csv") %>% select(-c("id","date"))
?select
house <- read.csv("data_input/kc_house_data.csv") %>% dplyr::select(-c(1:2))
head(house)
model_house <- lm(price~.,data = house)
summary(model_house)
colSums(is.na(house))
summary(model_house)
summary(house$sqft_basement)
boxplot(house$sqft_basement)
read.csv("data_input/kc_house_data.csv")
house <- read.csv("data_input/kc_house_data.csv") %>% dplyr::select(-c(id,date,zipcode,lat,long))
head(house)
plot(house$sqft_lot, house$price)
model_house <- lm(price~.,data = house)
summary(model_house)
mean(house$sqft_basement)
house <- read.csv("data_input/kc_house_data.csv") %>% dplyr::select(-c(id,date,zipcode,lat,long,sqft_basement))
head(house)
mean(house$sqft_basement)
model_house <- lm(price~.,data = house)
summary(model_house)
model_house <- lm(price~sqft_living,data = house)
summary(model_house)
model_house <- lm(price~sqft_lot,data = house)
summary(model_house)
model_house <- lm(price~sqft_living,data = house)
summary(model_house)
library(MLmetrics)
?SSE
